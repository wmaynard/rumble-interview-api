<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Rumble Interview</title>
	<style>
		div#intro > table {
			border: solid 1px black;
			margin: 1.5em 0;
			border-collapse: collapse;
		}

		div#intro * tr:first-child {
			background-color: lightgray;
			font-weight: bolder;
		}

		div#intro * tr,
		div#intro * td {
			border:solid 1px darkgray;
			border-collapse: collapse;
		}
		div#intro * td {
			padding: 0 1em;
		}
		img {
			background-color: gray;
		}
	</style>
</head>
<body>

<img src="https://eng.towersandtitans.com/img/rumble-logo.png" alt="Rumble Logo" />

<hr />

<h1>Introduction</h1>
<div id="intro">
	This coding assessment will test you on API integrations.  Below this section is a form that hasn't been hooked up to an API; your goal is to make it "work".  You have the following documentation regarding the API:

	<table>
		<tr>
			<td>HTTP Method</td>
			<td>Relative URL</td>
			<td>Required Fields</td>
			<td>Comments</td>
		</tr>
		<tr>
			<td>DELETE</td>
			<td>/account</td>
			<td></td>
			<td>Requires token as authorization.  Deletes the account associated with the token.</td>
		</tr>
		<tr>
			<td>GET</td>
			<td>/mail</td>
			<td></td>
			<td>Requires token as authorization.  Returns any server messages for the user.</td>
		</tr>
		<tr>
			<td>POST</td>
			<td>/login</td>
			<td>password (string)<br />screenname (string)</td>
			<td>Logs in with the screenname and password.  Returns a JWT that can be used for other requests.</td>
		</tr>
		<tr>
			<td>POST</td>
			<td>/register</td>
			<td>email (string)<br />password (string)<br />screenname (string)</td>
			<td>Creates an account on the server using provided credentials.</td>
		</tr>
	</table>

	Recommended first steps:

	<ul>
		<li>Create a function to make web requests to the API.</li>
		<li>Create CRUD functions to handle JWTs (tokens).</li>
		<li>Hook up a form feature to the API with the web request function.</li>
		<li>Keep an eye on your console logs!</li>
	</ul>

	You're encouraged to add styling, but functionality should be the top priority.  Ask questions if you're stuck; I'm here to help!
</div>

<hr />
<h1>Login</h1>
<div id="login">
	<form>
		<label>
			<input type="text" name="screenname" placeholder="screenname">
		</label>
		<label>
			<input type="password" name="password" placeholder="password">
		</label>
		<label>
			<input type="button" name="submit" value="Login" onclick="onLogin(processForm(this))">
		</label>
	</form>
</div>

<hr />
<h1>Register</h1>
<div id="register">
	<form id="registerForm">
		<label>
			<input type="text" name="email" placeholder="email">
		</label>
		<label>
			<input type="text" name="screenname" placeholder="screenname">
		</label>
		<label>
			<input type="password" name="password" placeholder="password">
		</label>
		<label>
			<input type="button" name="submit" value="Submit" onclick="onRegister(processForm(this))">
		</label>
	</form>
</div>

<hr />
<h1>Delete Account</h1>
<div id="delete">
	<form>
		<label>
			<input type="button" name="submit" value="Delete Account" onclick="onDeleteAccount(processForm(this))">
		</label>
	</form>
</div>

<hr />
<h1>System Messages</h1>
<div id="mail">
	<form>
		<label>
			<input type="button" name="submit" value="Get Mail" onclick="onFetchMail(processForm(this))">
		</label>
	</form>
	<div id="messages">
		(No messages loaded yet)
	</div>
</div>


<div id="home">
</div>
<script>
	const baseUrl = "https://dev.nonprod.tower.cdrentertainment.com/interview/web-dev/";

	function onRegister(formData) {
		console.log("register");
	}

	function onLogin(formData) {
		console.log("login");
	}

	function onDeleteAccount(formData) {
		console.log("delete");

		// TODO: Use the provided token to call DELETE /interview/account.
	}

	function onFetchMail(formData) {
		console.log("get mail")

		// TODO: Use the provided token to call GET /interview/mail.
	}

	function displayMail(messages) {
		console.log("display messages");

		// TODO: Craft the messages here.
	}

	// This function extracts form data from button clicks and processes it into a JSON object.
	function processForm(button) {
		let form = button.parentElement.parentElement;

		let output = {};

		Array.from(form.children).forEach(function(child) {
			Array.from(child.children).forEach(function(input) {
				if (input.type === "text" || input.type === "password") {
					output[input.name] = input.value;
					input.value = "";
				}
			});
		});

		return output;
	}
</script>
</body>
</html>